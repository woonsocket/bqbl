import requests
from lxml import etree

PASSING = './/*[@id="gamepackage-passing"]'
ONE= '//div[@class="col column-one gamepackage-away-wrap"]'
TWO= '//div[@class="col column-two gamepackage-home-wrap"]'
TOTAL= '//tr[@class="highlight"]'
C_ATT= './/td[@class="c-att"]'
YDS = './/td[@class="yds"]'
TD = './/td[@class="td"]'
INT = './/td[@class="int"]'
SACKS = './/td[@class="sacks"]'
FUM = './/td[@class="fum"]'
LOST = './/td[@class="lost"]'
REC = './/td[@class="rec"]'
LONG = './/td[@class="long"]'
TEAM_NAME = '//div[@class="team-name"]'
RUSHING = './/*[@id="gamepackage-rushing"]'
FUMBLING = './/*[@id="gamepackage-fumbles"]'
RECEIVING = './/*[@id="gamepackage-receiving"]'
INTERCEPTIONS = './/*[@id="gamepackage-interceptions"]'
PLAYER = './/td[@class="name"]'
ONE_NAME = '//div[contains(@class, "away")]//span[@class="abbrev"]'
TWO_NAME = '//div[contains(@class, "home")]//span[@class="abbrev"]'
CLOCK = '//span[contains(@class,"status-detail")]'
GAMES = "//a[@name='&lpos=nfl:scoreboard:boxscore']"

gameIds = eval("""{'2009': {'1': ['290910023', '290913001', '290913004', '290913005', '290913011', '290913018', '290913027', '290913029', '290913033', '290913034', '290913019', '290913022', '290913026', '290913009', '290914017', '290914013'], '2': ['290920001', '290920008', '290920009', '290920010', '290920012', '290920020', '290920021', '290920028', '290920030', '290920002', '290920025', '290920003', '290920007', '290920024', '290920006', '290921015'], '3': ['290927008', '290927014', '290927016', '290927017', '290927020', '290927021', '290927027', '290927033', '290927034', '290927002', '290927026', '290927004', '290927013', '290927024', '290927022', '290928006'], '4': ['291004003', '291004005', '291004011', '291004012', '291004017', '291004028', '291004030', '291004034', '291004015', '291004018', '291004007', '291004025', '291004023', '291005016'], '5': ['291011002', '291011008', '291011012', '291011014', '291011019', '291011021', '291011029', '291011033', '291011025', '291011007', '291011022', '291011026', '291011010', '291012015'], '6': ['291018004', '291018009', '291018016', '291018018', '291018023', '291018027', '291018028', '291018030', '291018013', '291018026', '291018017', '291018020', '291018001', '291019024'], '7': ['291025005', '291025012', '291025014', '291025023', '291025027', '291025034', '291025013', '291025029', '291025004', '291025006', '291025015', '291025019', '291026028'], '8': ['291101002', '291101003', '291101006', '291101008', '291101011', '291101020', '291101021', '291101033', '291101010', '291101024', '291101009', '291101022', '291102018'], '9': ['291108001', '291108003', '291108004', '291108011', '291108017', '291108027', '291108030', '291108018', '291108026', '291108019', '291108025', '291108021', '291109007'], '10': ['291112025', '291115010', '291115014', '291115015', '291115016', '291115020', '291115023', '291115028', '291115029', '291115013', '291115009', '291115022', '291115024', '291115011', '291116005'], '11': ['291119029', '291122006', '291122008', '291122009', '291122012', '291122016', '291122019', '291122027', '291122030', '291122033', '291122014', '291122007', '291122013', '291122017', '291122003', '291123034'], '12': ['291126008', '291126006', '291126007', '291129001', '291129002', '291129004', '291129014', '291129020', '291129021', '291129034', '291129024', '291129025', '291129010', '291129016', '291129033', '291130018'], '13': ['291203002', '291206001', '291206003', '291206004', '291206011', '291206012', '291206015', '291206023', '291206028', '291206029', '291206030', '291206005', '291206019', '291206026', '291206022', '291207009'], '14': ['291210005', '291213001', '291213003', '291213011', '291213012', '291213016', '291213017', '291213027', '291213030', '291213033', '291213034', '291213010', '291213013', '291213006', '291213019', '291214025'], '15': ['291217030', '291219018', '291220002', '291220008', '291220010', '291220012', '291220014', '291220020', '291220007', '291220024', '291220021', '291220023', '291220026', '291220033', '291220029', '291221028'], '16': ['291225010', '291227001', '291227004', '291227005', '291227009', '291227015', '291227017', '291227018', '291227019', '291227023', '291227022', '291227025', '291227011', '291227021', '291227028', '291228003'], '17': ['300103002', '300103005', '300103008', '300103014', '300103015', '300103016', '300103027', '300103029', '300103034', '300103006', '300103007', '300103013', '300103022', '300103024', '300103026', '300103020']}, '2010': {'1': ['300909018', '300912002', '300912003', '300912010', '300912017', '300912019', '300912023', '300912027', '300912030', '300912034', '300912014', '300912021', '300912026', '300912028', '300913020', '300913012'], '2': ['300919001', '300919004', '300919005', '300919006', '300919008', '300919009', '300919010', '300919016', '300919029', '300919007', '300919013', '300919020', '300919024', '300919028', '300919011', '300920025'], '3': ['300926012', '300926016', '300926017', '300926018', '300926019', '300926027', '300926029', '300926033', '300926034', '300926014', '300926030', '300926007', '300926022', '300926026', '300926015', '300927003'], '4': ['301003001', '301003002', '301003005', '301003009', '301003010', '301003014', '301003018', '301003023', '301003013', '301003030', '301003021', '301003024', '301003019', '301004015'], '5': ['301010002', '301010004', '301010005', '301010008', '301010011', '301010028', '301010029', '301010033', '301010034', '301010022', '301010006', '301010013', '301010025', '301011020'], '6': ['301017003', '301017009', '301017014', '301017017', '301017019', '301017021', '301017023', '301017027', '301017034', '301017007', '301017025', '301017016', '301017028', '301018030'], '7': ['301024001', '301024003', '301024010', '301024012', '301024015', '301024018', '301024027', '301024029', '301024033', '301024026', '301024007', '301024024', '301024009', '301025006'], '8': ['301031004', '301031006', '301031008', '301031012', '301031014', '301031020', '301031025', '301031024', '301031013', '301031017', '301031022', '301031018', '301101011'], '9': ['301107001', '301107002', '301107005', '301107008', '301107016', '301107029', '301107033', '301107034', '301107026', '301107013', '301107021', '301107009', '301108004'], '10': ['301111001', '301114002', '301114003', '301114005', '301114011', '301114015', '301114027', '301114030', '301114007', '301114019', '301114022', '301114025', '301114023', '301115028'], '11': ['301118015', '301121004', '301121006', '301121010', '301121012', '301121016', '301121020', '301121023', '301121029', '301121030', '301121014', '301121018', '301121025', '301121017', '301121021', '301122024'], '12': ['301125008', '301125006', '301125020', '301128001', '301128002', '301128005', '301128019', '301128028', '301128034', '301128013', '301128026', '301128003', '301128007', '301128033', '301128011', '301129022'], '13': ['301202021', '301205004', '301205008', '301205009', '301205010', '301205012', '301205015', '301205016', '301205019', '301205024', '301205011', '301205022', '301205026', '301205027', '301205033', '301206017'], '14': ['301209010', '301212002', '301212008', '301212023', '301212028', '301212029', '301212030', '301212018', '301212025', '301212003', '301212020', '301212022', '301212024', '301212006', '301213016', '301213034'], '15': ['301216024', '301219004', '301219006', '301219010', '301219011', '301219014', '301219015', '301219019', '301219027', '301219029', '301219033', '301219026', '301219013', '301219023', '301219017', '301220016'], '16': ['301223023', '301225022', '301226002', '301226003', '301226005', '301226012', '301226014', '301226015', '301226030', '301226004', '301226007', '301226013', '301226009', '301226027', '301227001', '301228021'], '17': ['310102001', '310102005', '310102008', '310102012', '310102017', '310102018', '310102020', '310102033', '310102007', '310102009', '310102011', '310102021', '310102025', '310102028', '310102034', '310102026']}, '2011': {'1': ['310908009', '310911003', '310911005', '310911012', '310911014', '310911027', '310911030', '310911033', '310911034', '310911022', '310911024', '310911025', '310911028', '310911020', '310912015', '310912007'], '2': ['310918002', '310918008', '310918010', '310918011', '310918016', '310918018', '310918020', '310918023', '310918028', '310918029', '310918025', '310918007', '310918015', '310918017', '310918001', '310919019'], '3': ['310925002', '310925004', '310925005', '310925010', '310925016', '310925018', '310925021', '310925029', '310925013', '310925014', '310925024', '310925003', '310925026', '310925027', '310925011', '310926006'], '4': ['311002003', '311002004', '311002005', '311002006', '311002012', '311002014', '311002021', '311002030', '311002034', '311002022', '311002026', '311002009', '311002013', '311002024', '311002033', '311003027'], '5': ['311009002', '311009011', '311009016', '311009019', '311009023', '311009029', '311009030', '311009034', '311009025', '311009007', '311009017', '311009001', '311010008'], '6': ['311016001', '311016004', '311016008', '311016009', '311016019', '311016023', '311016028', '311016013', '311016033', '311016017', '311016027', '311016003', '311017020'], '7': ['311023005', '311023008', '311023010', '311023015', '311023020', '311023027', '311023029', '311023013', '311023022', '311023006', '311023016', '311023018', '311024030'], '8': ['311030010', '311030014', '311030019', '311030029', '311030033', '311030034', '311030002', '311030007', '311030023', '311030025', '311030026', '311030021', '311031012'], '9': ['311106002', '311106006', '311106011', '311106012', '311106018', '311106028', '311106034', '311106010', '311106013', '311106017', '311106022', '311106024', '311106023', '311107021'], '10': ['311110024', '311113001', '311113004', '311113005', '311113006', '311113011', '311113012', '311113015', '311113021', '311113027', '311113029', '311113026', '311113003', '311113025', '311113020', '311114009'], '11': ['311117007', '311120005', '311120008', '311120009', '311120015', '311120016', '311120028', '311120033', '311120014', '311120025', '311120001', '311120003', '311120019', '311121017'], '12': ['311124008', '311124006', '311124033', '311127001', '311127004', '311127010', '311127011', '311127014', '311127020', '311127030', '311127013', '311127026', '311127021', '311127024', '311127012', '311128018'], '13': ['311201026', '311204002', '311204003', '311204015', '311204016', '311204017', '311204023', '311204027', '311204028', '311204034', '311204005', '311204019', '311204022', '311204025', '311204018', '311205030'], '14': ['311208023', '311211004', '311211008', '311211010', '311211015', '311211020', '311211028', '311211029', '311211030', '311211033', '311211007', '311211022', '311211009', '311211024', '311211006', '311212026'], '15': ['311215001', '311217027', '311218002', '311218003', '311218011', '311218012', '311218014', '311218016', '311218019', '311218034', '311218013', '311218007', '311218021', '311218022', '311218024', '311219025'], 
'16': ['311222011', '311224002', '311224004', '311224010', '311224012', '311224017', '311224020', '311224023', '311224028', '311224029', '311224033', '311224008', '311224006', '311224026', '311225009', '311226018'], '17': ['320101009', '320101014', '320101015', '320101016', '320101017', '320101018', '320101021', '320101030', '320101034', '320101001', '320101004', '320101005', '320101007', '320101013', '320101022', '320101019']}, '2012': {'1': ['320905019', '320909003', '320909005', '320909008', '320909010', '320909012', '320909016', '320909018', '320909020', '320909034', '320909009', '320909022', '320909027', '320909007', '320910033', '320910013'], '2': ['320913009', '320916002', '320916004', '320916011', '320916015', '320916017', '320916019', '320916021', '320916029', '320916030', '320916014', '320916026', '320916023', '320916024', '320916025', '320917001'], '3': ['320920029', '320923003', '320923005', '320923006', '320923010', '320923011', '320923015', '320923016', '320923018', '320923028', '320923022', '320923024', '320923007', '320923013', '320923033', '320924026'], '4': ['320927033', '320930001', '320930002', '320930008', '320930012', '320930014', '320930020', '320930034', '320930007', '320930022', '320930030', '320930009', '320930027', '320930021', '321001006'], '5': ['321004014', '321007004', '321007011', '321007012', '321007019', '321007023', '321007028', '321007029', '321007030', '321007016', '321007017', '321007025', '321007018', '321008020'], '6': ['321011010', '321014001', '321014005', '321014015', '321014020', '321014021', '321014027', '321014033', '321014022', '321014026', '321014025', '321014028', '321014034', '321015024'], '7': ['321018025', '321021002', '321021011', '321021014', '321021016', '321021019', '321021027', '321021029', '321021034', '321021013', '321021017', '321021004', '321022003'], '8': ['321025016', '321028003', '321028005', '321028008', '321028009', '321028010', '321028014', '321028020', '321028021', '321028023', '321028012', '321028006', '321028007', '321029022'], '9': ['321101024', '321104004', '321104005', '321104009', '321104010', '321104011', '321104028', '321104030', '321104034', '321104013', '321104026', '321104019', '321104001', '321105018'], '10': ['321108030', '321111004', '321111015', '321111016', '321111017', '321111018', '321111027', '321111029', '321111033', '321111026', '321111021', '321111025', '321111003', '321112023'], '11': ['321115002', '321118001', '321118006', '321118008', '321118012', '321118014', '321118028', '321118029', '321118034', '321118013', '321118007', '321118017', '321118023', '321119025'], '12': ['321122008', '321122006', '321122020', '321125003', '321125004', '321125005', '321125011', '321125012', '321125015', '321125027', '321125030', '321125024', '321125018', '321125022', '321125019', '321126021'], '13': ['321129001', '321202002', '321202003', '321202008', '321202009', '321202010', '321202012', '321202014', '321202015', '321202020', '321202007', '321202013', '321202024', '321202033', '321202006', '321203028'], '14': ['321206013', '321209002', '321209004', '321209005', '321209011', '321209016', '321209023', '321209027', '321209028', '321209029', '321209030', '321209025', '321209019', '321209026', '321209009', '321210017'], '15': ['321213021', '321216001', '321216003', '321216005', '321216014', '321216015', '321216018', '321216033', '321216034', '321216002', '321216022', '321216024', '321216006', '321216013', '321216017', '321217010'], '16': ['321222008', '321223006', '321223009', '321223012', '321223015', '321223020', '321223021', '321223023', '321223027', '321223029', '321223030', '321223034', '321223007', '321223022', '321223033', '321223026'], '17': ['321230001', '321230002', '321230004', '321230008', '321230010', '321230011', '321230018', '321230019', '321230023', '321230007', '321230016', '321230017', '321230024', '321230025', '321230026', '321230028']}, '2013': {'1': ['330905007', '330908002', '330908003', '330908005', '330908008', '330908011', '330908018', '330908020', '330908023', '330908029', '330908030', '330908014', '330908025', '330908006', '330909028', '330909024'], '2': ['330912017', '330915001', '330915002', '330915003', '330915009', '330915011', '330915012', '330915021', '330915033', '330915034', '330915022', '330915027', '330915013', '330915019', '330915026', '330916004'], '3': ['330919021', '330922004', '330922006', '330922010', '330922016', '330922017', '330922018', '330922028', '330922029', '330922033', '330922015', '330922020', '330922025', '330922026', '330922023', '330923007'], '4': ['330926014', '330929002', '330929005', '330929008', '330929012', '330929016', '330929027', '330929030', '330929034', '330929010', '330929007', '330929013', '330929024', '330929001', '330930018'], '5': ['331003005', '331006003', '331006004', '331006009', '331006010', '331006011', '331006014', '331006015', '331006019', '331006022', '331006006', '331006025', '331006013', '331007001'], '6': ['331010003', '331013002', '331013005', '331013012', '331013016', '331013020', '331013027', '331013033', '331013034', '331013007', '331013026', '331013017', '331013025', '331013006', '331014024'], '7': ['331017022', '331020001', '331020008', '331020015', '331020020', '331020021', '331020028', '331020029', '331020030', '331020010', '331020009', '331020012', '331020023', '331020011', '331021019'], '8': ['331024027', '331027008', '331027012', '331027017', '331027018', '331027021', '331027030', '331027004', '331027013', '331027007', '331027022', '331027016', '331028014'], '9': ['331031015', '331103002', '331103006', '331103014', '331103020', '331103028', '331103029', '331103013', '331103026', '331103005', '331103017', '331103034', '331104009'], '10': ['331107016', '331110001', '331110003', '331110009', '331110010', '331110011', '331110019', '331110023', '331110033', '331110025', '331110022', '331110024', '331110018', '331111027'], '11': ['331114010', '331117002', '331117003', '331117004', '331117021', '331117023', '331117027', '331117030', '331117034', '331117015', '331117018', '331117019', '331117026', '331117007', '331118029'], '12': ['331121001', '331124005', '331124008', '331124009', '331124012', '331124014', '331124015', '331124033', '331124034', '331124013', '331124022', '331124019', '331124017', '331125028'], '13': ['331128008', '331128006', '331128033', '331201005', '331201011', '331201016', '331201020', '331201021', '331201029', '331201034', '331201002', '331201025', '331201012', '331201024', '331201028', '331202026'], '14': ['331205030', '331208004', '331208009', '331208017', '331208020', '331208021', '331208023', '331208027', '331208028', '331208033', '331208007', '331208022', '331208024', '331208025', '331208018', '331209003'], '15': ['331212007', '331215001', '331215005', '331215011', '331215015', '331215016', '331215019', '331215027', '331215030', '331215013', '331215029', '331215006', '331215010', '331215014', '331215023', '331216008'], '16': ['331222002', '331222004', '331222012', '331222014', '331222020', '331222028', '331222029', '331222030', '331222034', '331222008', '331222026', '331222009', '331222024', '331222033', '331222021', '331223025'], '17': ['331229001', '331229004', '331229010', '331229011', '331229015', '331229016', '331229019', '331229023', '331229003', '331229013', '331229017', '331229018', '331229022', '331229024', '331229026', '331229006']}, '2014': {'1': ['400554214', '400554215', '400554232', '400554260', '400554217', '400554262', '400554226', '400554223', '400554221', '400554229', '400554256', '400554269', '400554266', '400554273', '400554296', '400554301'], '2': ['400554196', '400554198', '400554245', '400554241', '400554206', '400554235', '400554211', '400554202', '400554249', '400554278', '400554274', '400554291', '400554287', '400554284', '400554314', '400554318'], '3': ['400554194', '400554195', '400554237', '400554240', '400554244', '400554199', '400554250', '400554213', '400554208', '400554203', '400554247', '400554253', '400554280', '400554276', '400554283', '400554288'], '4': ['400554201', '400554207', '400554238', '400554286', '400554252', '400554279', '400554248', '400554212', '400554290', '400554242', '400554315', '400554319', '400554325'], '5': ['400554197', '400554234', '400554236', '400554204', '400554239', '400554210', '400554209', '400554205', '400554200', '400554243', '400554246', '400554275', '400554251', '400554277', '400554282'], '6': ['400554216', '400554259', '400554263', '400554295', '400554222', '400554299', '400554255', '400554231', '400554225', '400554302', '400554220', '400554308', '400554305', '400554312', '400554335'], '7': ['400554219', '400554268', '400554270', '400554271', '400554294', '400554265', '400554257', '400554233', '400554261', '400554228', '400554297', '400554304', '400554300', '400554307', '400554311'], '8': ['400554218', '400554224', '400554264', '400554230', '400554227', '400554272', '400554298', '400554254', '400554258', '400554267', '400554303', '400554306', '400554310', '400554313', '400554336'], '9': ['400554309', '400554344', '400554334', '400554337', '400554341', '400554347', '400554351', '400554339', '400554377', '400554381', '400554385', '400554389', '400554393'], '10': ['400554328', '400554332', '400554355', '400554362', '400554370', '400554372', '400554358', '400554367', '400554396', '400554397', '400554400', '400554403', '400554408'], '11': ['400554338', '400554340', '400554343', '400554348', '400554383', '400554375', '400554387', '400554378', '400554352', '400554391', '400554345', '400554414', '400554417', '400554421'], '12': ['400554293', '400554317', '400554333', '400554326', '400554324', '400554322', '400554320', '400554329', '400554360', '400554357', '400554364', '400554365', '400554369', '400554331', '400607990', '400554394'], '13': ['400554281', '400554285', '400554289', '400554321', '400554292', '400554354', '400554363', '400554359', '400554330', '400554327', '400554323', '400554316', '400554368', '400554371', '400554395', '400554399'], 
'14': ['400554349', '400554374', '400554422', '400554424', '400554384', '400554419', '400554416', '400554388', '400554379', '400554426', '400554428', '400554429', '400554431', '400554430', '400554432', '400554433'], '15': ['400554342', '400554346', '400554386', '400554392', '400554380', '400554376', '400554353', '400554350', '400554390', '400554382', '400554418', '400554420', '400554415', '400554423', '400554425', '400554427'], '16': ['400554356', '400554366', '400554361', '400554401', '400554373', '400554406', '400554436', '400554434', '400554410', '400554402', '400554398', '400554439', '400554444', '400554442', '400554447', '400554449'], '17': ['400554409', '400554413', '400554435', '400554437', '400554438', '400554440', '400554443', '400554407', '400554405', '400554412', '400554404', '400554445', '400554411', '400554446', '400554448', '400554441']}, '2015': {'1': ['400791485', '400791541', '400791489', '400791550', '400791497', '400791544', '400791547', '400791493', '400791555', '400791558', '400791587', '400791585', '400791582', '400791590', '400791596', '400791600'], '2': ['400791624', '400791664', '400791661', '400791666', '400791669', '400791638', '400791634', '400791672', '400791630', '400791675', '400791628', '400791702', '400791680', '400791705', '400791708', '400791711'], '3': ['400791484', '400791500', '400791491', '400791496', '400791594', '400791592', '400791553', '400791583', '400791557', '400791546', '400791589', '400791597', '400791623', '400791626', '400791631', '400791635'], '4': ['400791662', '400761514', '400791709', '400791678', '400791706', '400791712', '400791671', '400791701', '400791704', '400791714', '400791719', '400791718', '400791716', '400791720', '400791741'], '5': ['400791487', '400791495', '400791492', '400791548', '400791551', '400791488', '400791542', '400791498', '400791545', '400791554', '400791559', '400791560', '400791584', '400791588'], '6': ['400791593', '400791627', '400791633', '400791629', '400791639', '400791625', '400791598', '400791621', '400791637', '400791663', '400791667', '400791670', '400791674', '400791676'], '7': ['400791503', '400761515', '400791523', '400791517', '400791520', '400791527', '400791529', '400791533', '400791536', '400791511', '400791540', '400791564', '400791567', '400791574'], '8': ['400791601', '400761516', '400791605', '400791642', '400791609', '400791613', '400791618', '400791649', '400791646', '400791653', '400791657', '400791681', '400791684', '400791690'], '9': ['400791698', '400791725', '400791727', '400791721', '400791722', '400791728', '400791730', '400791700', '400791732', '400791731', '400791733', '400791734', '400791735'], '10': ['400791486', '400791490', '400791499', '400791543', '400791552', '400791556', '400791494', '400791549', '400791581', '400791586', '400791595', '400791591', '400791599', '400791622'], '11': ['400791632', '400791640', '400791673', '400791636', '400791703', '400791668', '400791707', '400791679', '400791665', '400791715', '400791677', '400791713', '400791710', '400791717'], '12': ['400791507', '400791509', '400791510', '400791514', '400791516', '400791502', '400791505', '400791504', '400791522', '400791506', '400791519', '400791512', '400791526', '400791532', '400791537', '400791561'], '13': ['400791568', '400791611', '400791647', '400791619', '400791643', '400791576', '400791615', '400791606', '400791572', '400791579', '400791655', '400791652', '400791658', '400791602', '400791682', '400791686'], '14': ['400791513', '400791580', '400791566', '400791530', '400791577', '400791534', '400791562', '400791524', '400791539', '400791604', '400791573', '400791616', '400791608', '400791612', '400791570', '400791641'], '15': ['400791650', '400791656', '400791688', '400791660', '400791694', '400791693', '400791695', '400791685', '400791696', '400791699', '400791697', '400791723', '400791724', '400791726', '400791692', '400791729'], '16': ['400791501', '400791508', '400791563', '400791535', '400791531', '400791518', '400791521', '400791525', '400791515', '400791538', '400791575', '400791528', '400791571', '400791569', '400791565', '400791578'], '17': ['400791614', '400791603', '400791659', '400791617', '400791620', '400791651', '400791645', '400791607', '400791654', '400791644', '400791687', '400791648', '400791689', '400791691', '400791610', '400791683']}, '2016': {'1': ['400874484', '400874522', '400874524', '400874570', '400874543', '400874527', '400874520', '400874486', '400874510', '400874511', '400874577', '400874574', '400874573', '400874539', '400874537', '400874532'], '2': ['400874530', '400874512', '400874488', '400874541', '400874529', '400874487', '400874518', '400874535', '400874549', '400874514', '400874515', '400874526', '400874525', '400874517', '400874545', '400874547'], '3': ['400874551', '400874558', '400874613', '400874610', '400874562', '400874565', '400874682', '400874615', '400874567', '400874620', '400874618', '400874624', '400874623', '400874628', '400874650', '400874653'], '4': ['400874655', '400874657', '400874664', '400874668', '400874663', '400874662', '400874660', '400874666', '400874658', '400874669', '400874671', '400874672', '400874674', '400874675', '400874677'], '5': ['400874483', '400874519', '400874533', '400874548', '400874581', '400874595', '400874602', '400874590', '400874607', '400874630', '400874636', '400874633', '400874640', '400874648'], '6': ['400874693', '400874698', '400874708', '400874709', '400874703', '400874730', '400874736', '400874707', '400874705', '400874701', '400874731', '400874733', '400874732', '400874734', '400874735'], '7': ['400874429', '400874490', '400874494', '400874496', '400874492', '400874491', '400874500', '400874501', '400874493', '400874498', '400874505', '400874503', '400874506', '400874508', '400874509'], '8': ['400874553', '400874555', '400874619', '400874612', '400874557', '400874564', '400874561', '400874625', '400874569', '400874622', '400874616', '400874629', '400874652'], '9': ['400874605', '400874599', '400874600', '400874601', '400874604', '400874603', '400874598', '400874596', '400874597', '400874594', '400874593', '400874592', '400874591'], '10': ['400874589', '400874572', '400874586', '400874584', '400874582', '400874578', '400874576', '400874580', '400874587', '400874544', '400874542', '400874538', '400874536', '400874531'], '11': ['400874609', '400874646', '400874634', '400874638', '400874641', '400874644', '400874649', '400874695', '400874691', '400874697', '400874700', '400874702', '400874704', '400874706'], '12': ['400874495', '400874499', '400874502', '400874566', '400874554', '400874507', '400874614', '400874654', '400874626', '400874560', '400874659', '400874665', '400874670', '400874680', '400874676', '400874684'], '13': ['400874713', '400874715', '400874723', '400874721', '400874720', '400874718', '400874717', '400874719', '400874722', '400874724', '400874726', '400874725', '400874727', '400874728', '400874729'], '14': ['400874428', '400874497', '400874563', '400874568', '400874504', '400874611', '400874556', '400874552', '400874559', '400874617', '400874621', '400874651', '400874627', '400874550', '400874656', '400874661'], '15': ['400874667', '400874673', '400874683', '400874678', '400874714', '400874686', '400874688', '400874687', '400874685', '400874681', '400874710', '400874689', '400874711', '400874712', '400874679', '400874716'], '16': ['400874485', '400874489', '400874534', '400874528', '400874523', '400874516', '400874540', '400874521', '400874546', '400874575', '400874513', '400874571', '400874579', '400874583', '400874585', '400874588'], '17': ['400874608', '400874632', '400874639', '400874642', '400874643', '400874645', '400874647', '400874690', '400874635', '400874606', '400874694', '400874692', '400874696', '400874699', '400874631', '400874637']}, '2017': {'1': ['400951566', '400951567', '400951570', '400951572', '400951574', '400951576', '400951584', '400951592', '400951580', '400951597', '400951601', '400951605', '400951608', '400951581', '400951612', '400951615'], '2': ['400951620', '400951632', '400951636', '400951639', '400951643', '400951645', '400951630', '400951635', '400951626', '400951669', '400951666', '400951673', '400951674', '400951676', '400951679', '400951681'], '3': ['400951568', '400951579', '400951583', '400951590', '400951594', '400951599', '400951604', '400951607', '400951611', '400951616', '400951587', '400951623', '400951627', '400951634', '400951644', '400951668'], '4': ['400951678', '400950241', '400951685', '400951712', '400951716', '400951724', '400951727', '400951730', '400951708', '400951720', '400951735', '400951738', '400951742', '400951744', '400951747', '400951752'], '5': ['400951552', '400951554', '400951556', '400951558', '400951562', '400951646', '400951650', '400951651', '400951655', '400951659', '400951657', '400951661', '400951664', '400951691'], '6': ['400951695', '400951697', '400951702', '400951704', '400951766', '400951767', '400951699', '400951700', '400951770', '400951773', '400951776', '400951779', '400951782', '400951785'], '7': ['400951571', '400951575', '400951578', '400951582', '400951585', '400951589', '400951593', '400951598', '400951603', '400951619', '400951628', '400951609', '400951624', '400951638', '400951641'], '8': ['400951670', '400951683', '400951706', '400951711', '400951715', '400951717', '400951721', '400951723', '400951725', '400951729', '400951732', '400951736', '400951737'], '9': ['400951743', '400951761', '400951755', '400951758', '400951760', '400951749', '400951753', '400951751', '400951763', '400951765', '400951786', '400951787', '400951790'], '10': ['400951553', '400951555', '400951559', '400951563', '400951656', '400951565', '400951653', '400951658', '400951648', '400951663', '400951686', '400951688', '400951690', '400951693'], '11': ['400951698', '400951701', '400951769', '400951703', '400981391', '400951775', '400951780', '400951783', '400951771', '400951807', '400951810', '400951815', '400951817', '400951818'],
 '12': ['400951569', '400951573', '400951577', '400951586', '400951588', '400951591', '400951595', '400951600', '400951606', '400951610', '400951618', '400951629', '400951614', '400951622', '400951633', '400951640'], '13': ['400951672', '400951677', '400951684', '400951707', '400951710', '400951728', '400951718', '400951726', '400951713', '400951680', '400951731', '400951740', '400951722', '400951733', '400951746', '400951754'], '14': ['400951557', '400951560', '400951564', '400951647', '400951654', '400951692', '400951660', '400951561', '400951649', '400951665', '400951662', '400951687', '400951689', '400951652', '400951694', '400951696'], '15': ['400951705', '400951768', '400951772', '400951774', '400951778', '400951784', '400951806', '400951808', '400951809', '400951777', '400951781', '400951811', '400951812', '400951813', '400951814', '400951816'], '16': ['400951596', '400951602', '400951617', '400951621', '400951667', '400951625', '400951631', '400951637', '400951642', '400951671', '400951613', '400951675', '400951709', '400951682', '400951714', '400951719'], '17': ['400951741', '400951745', '400951750', '400951756', '400951757', '400951759', '400951762', '400951734', '400951789', '400951788', '400951792', '400951748', '400951791', '400951793', '400951764', '400951739']}, '2018': {'1': ['401030710', '401030718', '401030717', '401030716', '401030715', '401030714', '401030713', '401030712', '401030711', '401030720', '401030721', '401030725', '401030723', '401030726', '401030728', '401030751'], '2': ['401030690', '401030691', '401030704', '401030705', '401030694', '401030708', '401030700', '401030698', '401030696', '401030693', '401030732', '401030730', '401030736', '401030733', '401030738', '401030739'], '3': ['401030775', '401030777', '401030795', '401030787', '401030784', '401030782', '401030781', '401030790', '401030794', '401030788', '401030791', '401030798', '401030801', '401030799', '401030802', '401030805'], '4': ['401030839', '401030847', '401030846', '401030845', '401030844', '401030842', '401030843', '401030841', '401030840', '401030930', '401030848', '401030931', '401030932', '401030933', '401030934'], '5': ['401030697', '401030702', '401030785', '401030770', '401030745', '401030741', '401030734', '401030709', '401030778', '401030793', '401030803', '401030797', '401030808', '401030831', '401030834'], '6': ['401030692', '401030695', '401030743', '401030746', '401030706', '401030771', '401030742', '401030737', '401030701', '401030748', '401030773', '401030776', '401030774', '401030779', '401030783'], '7': ['401030800', '401030792', '401030832', '401030833', '401030830', '401030809', '401030807', '401030806', '401030835', '401030836', '401030838', '401030837', '401030804', '401030796']}}""")

gameIds2020 = eval("""{'2020': {'1': ['401220225', '401220313', '401220116', '401220282', '401220300', '401220131', '401220268', '401220370', '401220195', '401220147', '401220161', '401220369', '401220352', '401220347', '401220256', '401220217'], '2': ['401220163', '401220281', '401220249', '401220291', '401220204', '401220192', '401220122', '401220144', '401220261', '401220177', '401220329', '401220340', '401220235', '401220181', '401220365', '401220231'], '3': ['401220201', '401220309', '401220119', '401220168', '401220304', '401220134', '401220254', '401220264', '401220173', '401220193', '401220240', '401220216', '401220343', '401220363', '401220323', '401220153'], '4': ['401220141', '401220157', '401220247', '401220285', '401220128', '401220334', '401220271', '401220320', '401220184', '401220348', '401220280', '401220229', '401220355', '401220221', '401220293'], '5': ['401220278', '401220306', '401220219', '401220143', '401220175', '401220269', '401220146', '401220179', '401220358', '401220166', '401220242', '401220367', '401220326', '401220209'], '6': ['401220202', '401220190', '401220301', '401220133', '401220252', '401220263', '401220172', '401220317', '401220200', '401220124', '401220331', '401220353', '401220117', '401220245'], '7': ['401220259', '401220310', '401220155', '401249063', '401220322', '401220138', '401220266', '401220183', '401220232', '401220210', '401220136', '401220241', '401220338', '401220351'], '8': ['401220257', '401220314', '401220115', '401220158', '401220169', '401220288', '401220292', '401220222', '401220127', '401220148', '401220212', '401220277', '401220361', '401220258'], '9': ['401220359', '401220311', '401220120', '401220207', '401220189', '401220224', '401220299', '401220267', '401220194', '401220236', '401220248', '401220342', '401220330', '401220140'], '10': ['401220203', '401220165', '401220289', '401220295', '401220251', '401220368', '401220226', '401220126', '401220341', '401220346', '401220327', '401220171', '401220137', '401220276'], '11': ['401220360', '401220167', '401220191', '401220321', '401220272', '401220318', '401220198', '401220150', '401220185', '401220214', '401220238', '401220305', '401220227', '401220335'], '12': ['401220287', '401220244', '401220170', '401220312', '401220118', '401220160', '401220188', '401220302', '401220135', '401220139', '401220197', '401220215', '401220345', '401220333', '401220290', '401220262'], '13': ['401220151', '401220307', '401220274', '401220205', '401220129', '401220303', '401220142', '401220176', '401220178', '401220336', '401220364', '401220297', '401220237', '401220218', '401220357'], '14': ['401220349', '401220279', '401220159', '401220283', '401220125', '401220253', '401220332', '401220319', '401220196', '401220233', '401220366', '401220265', '401220239', '401220356', '401220121', '401220162'], '15': ['401220228', '401220213', '401220294', '401220208', '401220186', '401220350', '401220308', '401220123', '401220298', '401220255', '401220270', '401220149', '401220339', '401220325', '401220246', '401220156'], '16': ['401220324', '401220286', '401220230', '401220145', '401220337', '401220234', '401220223', '401220174', '401220273', '401220199', '401220152', '401220182', '401220362', '401220243', '401220296', '401220130'], '17': ['401220114', '401220275', '401220154', '401220164', '401220284', '401220187', '401220220', '401220132', '401220250', '401220260', '401220328', '401220315', '401220180', '401220211', '401220344', '401220354']}}""")
# let ids = []; for (let anchor of $x("//a[@name='&lpos=nfl:scoreboard:gamecast']")) {let components = anchor.href.split('/'); ids.push(components[components.length - 1])}; console.log(ids)

def all_games(year, week):
  if year == '2020':
    return gameIds2020['2020'][week]
  else:
    return gameIds[year][week]


def all_passers(tree):
  if not tree: return []
  assert len(tree) == 1
  tree = tree[0]

  # Omit last element, which is the total
  passer_paths = tree.xpath(PLAYER)[:-1]
  passers = {}
  for path in passer_paths:
    root = path.getparent()
    link = path.xpath(".//a")[0]
    name = path.xpath(".//a//span")[0].text
    uid = link.get('data-player-uid').split(":")[-1]
    passer = {'NAME': name}
    extract_pass_attrs([root], passer)
    passers[uid] = passer
  return passers

def extract_pass_attrs(tree, dst):
  if not tree: return
  assert len(tree) == 1
  tree = tree[0]
  dst["CMP"], dst["ATT"] = map(int, tree.xpath(C_ATT)[0].text.split('/'))
  dst["SACK"], dst["SACKYD"] = map(int, tree.xpath(SACKS)[0].text.split('-'))
  dst["PASSYD"] = int(tree.xpath(YDS)[0].text)
  dst["PASSTD"] = int(tree.xpath(TD)[0].text)
  dst["INT"] = int(tree.xpath(INT)[0].text)

def extract_rush_attrs(tree, dst):
  if not tree: return
  assert len(tree) == 1
  tree = tree[0]
  dst["RUSHYD"] = int(tree.xpath(YDS)[0].text)
  dst["RUSHTD"] = int(tree.xpath(TD)[0].text)
  
def extract_fumble_attrs(tree, dst):
  if not tree: return
  assert len(tree) == 1
  tree = tree[0]
  dst["FUM"] = int(tree.xpath(FUM)[0].text)
  dst["FUMLOST"] = int(tree.xpath(LOST)[0].text)
  dst["REC"] = int(tree.xpath(REC)[0].text)

def extract_receiving_attrs(tree, dst):
  if not tree: return
  assert len(tree) == 1
  tree = tree[0]
  dst["LONG"] = int(tree.xpath(LONG)[0].text)

def extract_interception_attrs(tree, dst):
  if not tree: return
  assert len(tree) == 1
  tree = tree[0]
  dst["INT6"] = int(tree.xpath(TD)[0].text)

def extract_passer_rushing(tree, name, dst):
  assert len(tree) == 1
  tree = tree[0]

  # Omit last element, which is the total
  rusher_paths = tree.xpath(PLAYER)[:-1]
  for path in rusher_paths:
    # TODO pull out name into function
    root = path.getparent()
    rusher_name = path.xpath(".//a//span")[0].text
    if rusher_name != name: continue
    extract_rush_attrs([root], dst)

def extract_passer_fumbling(tree, name, dst):
  assert len(tree) == 1
  tree = tree[0]

  # Omit last element, which is the total
  fumbler_paths = tree.xpath(PLAYER)[:-1]
  for path in fumbler_paths:
    # TODO pull out name into function
    root = path.getparent()
    fumbler_name = path.xpath(".//a//span")[0].text
    if fumbler_name != name: continue
    extract_fumble_attrs([root], dst)


def extract_game(tree, home=True):
  column = TWO if home else ONE
  other_column = ONE if home else TWO
  team_path = TWO_NAME if home else ONE_NAME
  opp_path = ONE_NAME if home else TWO_NAME
  team_name = tree.xpath(team_path)[0].text
  opp_name = tree.xpath(team_path)[0].text
  team = {'ATT': 0, 'CLOCK': 0, 'CMP': 0, 'FIELDPOS': 100, 'ID': 0, 'INT': 0, 'LONG': 0, 'FUM': 0, 'FUML': 0,
   'OPP': opp_name, 'PASSERS': [], 'PASSTD': 0, 'PASSYD': 0, 'RUSHYD': 0, 'RUSHTD': 0, 'SACK': 0, 'SACKYD': 0, 'SCORE': [], 'TD': 0
  }
  team["CLOCK"] = tree.xpath(CLOCK)[0].text
  if not team["CLOCK"]:
    # Game hasn't started yet
    return None, team_name
  extract_pass_attrs(tree.xpath(PASSING + column + TOTAL), team)
  extract_receiving_attrs(tree.xpath(RECEIVING + column + TOTAL), team)
  extract_interception_attrs(tree.xpath(INTERCEPTIONS + other_column + TOTAL), team)
  team['PASSERS'] = all_passers(tree.xpath(PASSING + column))

  for passer_id in team['PASSERS']:
    extract_passer_rushing(tree.xpath(RUSHING + column), team['PASSERS'][passer_id]['NAME'], team['PASSERS'][passer_id])
    extract_passer_fumbling(tree.xpath(FUMBLING + column), team['PASSERS'][passer_id]['NAME'], team['PASSERS'][passer_id])
    team['FUM'] += team['PASSERS'][passer_id].get('FUM', 0)
    team['FUML'] += team['PASSERS'][passer_id].get('FUMLOST', 0)
    team['RUSHTD'] += team['PASSERS'][passer_id].get('RUSHTD', 0)

  team['TD'] = team['RUSHTD'] + team["PASSTD"]
  return team, team_name

def mickey_parse(url, dst):
  headers = {'Content-Type': 'text/html',}
  response = requests.get(url, headers=headers)
  html = response.text
  tree = etree.HTML(html)
  team, team_key = extract_game(tree, home=False)
  if team:
    dst[team_key] = team
  team_2, team_key_2 = extract_game(tree, home=True)
  if team_2:
    dst[team_key_2] = team_2
  return team_key, team_key_2

if __name__ == "__main__":
  url = 'https://www.espn.com/nfl/boxscore?gameId=401128096'
  url = 'https://www.espn.com/nfl/boxscore?gameId=401128100'
  url = 'https://www.espn.com/nfl/boxscore?gameId=401220268'
  dst = {}
  mickey_parse(url, dst)
  print(dst)
